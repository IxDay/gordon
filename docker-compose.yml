version: "2"
services:
  db:
    ports:
        - "5432:5432"
    build:
      context: .
      dockerfile: dockerfiles/dockerfile-potato
      args:
        - PASSWORD=${DB_PASSWORD}
  dbwatcher:
    volumes:
      - ./potato:/mnt/
    links:
      - db
    build:
      context: .
      dockerfile: dockerfiles/dockerfile-potato-watcher
      args:
        - PASSWORD=${DB_PASSWORD}
  api:
    volumes:
      - ./lasagna:/opt/lasagna
      - ./dessert/dist:/opt/lasagna/lasagna/api/base/static
    links:
      - db
    ports:
      - "5000:5000"
    command: /bin/bash
    stdin_open: true
    tty: true
    build:
      context: .
      dockerfile: dockerfiles/dockerfile-lasagna
  front:
    volumes:
      - ./dessert:/opt/dessert
    build:
      context: .
      dockerfile: dockerfiles/dockerfile-dessert
